{"version":3,"file":"custom-tabbar.js","sources":["custom-tabbar.vue","RDovd29ya3NwYWNlL0NsaWVudFdvcmtBcmVhL-ivgeeFp-Wwj-eoi-W6jy9taW5pYXBwL3pmYi11bmlhcHAvY29tcG9uZW50cy9jdXN0b20tdGFiYmFyL2N1c3RvbS10YWJiYXIudnVl"],"sourcesContent":["<template>\r\n  <view class=\"custom-tabbar\" :style=\"{ paddingBottom: safeAreaBottom + 'px' }\">\r\n    <!-- 毛玻璃背景效果 -->\r\n    <view class=\"tabbar-blur-bg\"></view>\r\n    \r\n    <!-- 顶部分割线 -->\r\n    <view class=\"tabbar-border\"></view>\r\n    \r\n    <!-- Tab项容器 -->\r\n    <view class=\"tabbar-content\">\r\n      <view \r\n        v-for=\"(item, index) in tabList\" \r\n        :key=\"index\"\r\n        class=\"tab-item\"\r\n        :class=\"{ active: currentTab === index }\"\r\n        @tap=\"switchTab(index)\"\r\n      >\r\n        <!-- 背景光晕效果 -->\r\n        <view class=\"tab-glow\" v-if=\"currentTab === index\"></view>\r\n        \r\n        <!-- 图标容器 -->\r\n        <view class=\"tab-icon-wrapper\">\r\n          <!-- 使用SVG图标替代图片 -->\r\n          <view class=\"tab-svg-icon\" :class=\"{ active: currentTab === index }\">\r\n            <!-- 首页图标 -->\r\n            <view v-if=\"index === 0\" class=\"svg-home\">\r\n              <view class=\"home-base\"></view>\r\n              <view class=\"home-roof\"></view>\r\n              <view class=\"home-door\"></view>\r\n            </view>\r\n            \r\n            <!-- 订单图标 -->\r\n            <view v-else-if=\"index === 1\" class=\"svg-order\">\r\n              <view class=\"order-paper\"></view>\r\n              <view class=\"order-lines\"></view>\r\n              <view class=\"order-check\" v-if=\"currentTab === index\"></view>\r\n            </view>\r\n            \r\n            <!-- 我的图标 -->\r\n            <view v-else-if=\"index === 2\" class=\"svg-profile\">\r\n              <view class=\"profile-head\"></view>\r\n              <view class=\"profile-body\"></view>\r\n            </view>\r\n          </view>\r\n          \r\n          <!-- 激活状态的光点 -->\r\n          <view class=\"icon-dot\" v-if=\"currentTab === index\"></view>\r\n        </view>\r\n        \r\n        <!-- 文字 -->\r\n        <text class=\"tab-text\" :class=\"{ active: currentTab === index }\">\r\n          {{ item.text }}\r\n        </text>\r\n        \r\n        <!-- 激活指示器 -->\r\n        <view class=\"active-indicator\" v-if=\"currentTab === index\"></view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'CustomTabbar',\r\n  props: {\r\n    currentTab: {\r\n      type: Number,\r\n      default: 0\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      safeAreaBottom: 0,\r\n      tabList: [\r\n        {\r\n          pagePath: '/pages/home/home',\r\n          text: '首页',\r\n          iconPath: '/static/tabbar/home.svg',\r\n          selectedIconPath: '/static/tabbar/home-active.svg'\r\n        },\r\n        {\r\n          pagePath: '/pages/order/order',\r\n          text: '订单',\r\n          iconPath: '/static/tabbar/order.svg',\r\n          selectedIconPath: '/static/tabbar/order-active.svg'\r\n        },\r\n        {\r\n          pagePath: '/pages/profile/profile',\r\n          text: '我的',\r\n          iconPath: '/static/tabbar/profile.svg',\r\n          selectedIconPath: '/static/tabbar/profile-active.svg'\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getSafeAreaBottom()\r\n  },\r\n  methods: {\r\n    // 获取当前tab索引\r\n    getCurrentTab() {\r\n      try {\r\n        const pages = getCurrentPages()\r\n        if (pages.length > 0) {\r\n          const currentPage = pages[pages.length - 1]\r\n          const route = currentPage.route || currentPage.__route__\r\n          \r\n          console.log('当前页面路由:', route)\r\n          \r\n          this.tabList.forEach((item, index) => {\r\n            const pagePath = item.pagePath.replace('/', '')\r\n            if (route && (route.includes(pagePath) || route === pagePath)) {\r\n              this.currentTab = index\r\n              console.log('设置当前tab:', index, pagePath)\r\n            }\r\n          })\r\n        }\r\n      } catch (e) {\r\n        console.log('获取当前页面失败:', e)\r\n        // 降级方案：通过URL判断\r\n        const url = window.location ? window.location.href : ''\r\n        if (url.includes('home')) {\r\n          this.currentTab = 0\r\n        } else if (url.includes('order')) {\r\n          this.currentTab = 1\r\n        } else if (url.includes('profile')) {\r\n          this.currentTab = 2\r\n        }\r\n      }\r\n    },\r\n    \r\n    // 获取底部安全区域\r\n    getSafeAreaBottom() {\r\n      try {\r\n        const systemInfo = uni.getSystemInfoSync()\r\n        const safeArea = systemInfo.safeArea || {}\r\n        const screenHeight = systemInfo.screenHeight || systemInfo.windowHeight\r\n        \r\n        // 支付宝小程序特殊处理\r\n        if (systemInfo.platform === 'ios') {\r\n          // iPhone X 系列底部安全区域\r\n          this.safeAreaBottom = screenHeight - (safeArea.bottom || screenHeight)\r\n          // 最小安全距离\r\n          if (this.safeAreaBottom < 20) {\r\n            this.safeAreaBottom = systemInfo.statusBarHeight > 44 ? 34 : 0\r\n          }\r\n        } else {\r\n          // Android 设备通常不需要额外的底部安全区域\r\n          this.safeAreaBottom = Math.max(0, screenHeight - (safeArea.bottom || screenHeight))\r\n        }\r\n        \r\n        console.log('底部安全区域高度:', this.safeAreaBottom)\r\n      } catch (e) {\r\n        console.log('获取安全区域失败:', e)\r\n        this.safeAreaBottom = 0\r\n      }\r\n    },\r\n    \r\n    // 切换tab\r\n    switchTab(index) {\r\n      if (this.currentTab === index) return\r\n      \r\n      // 发送切换事件给父组件\r\n      this.$emit('tab-change', index)\r\n      \r\n      // 添加切换成功的反馈\r\n      uni.vibrateShort({\r\n        type: 'light'\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.custom-tabbar {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 1000;\r\n  background: rgba(255, 255, 255, 0.95);\r\n  backdrop-filter: blur(20px);\r\n  -webkit-backdrop-filter: blur(20px);\r\n}\r\n\r\n.tabbar-blur-bg {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: linear-gradient(180deg, \r\n    rgba(255, 255, 255, 0.9) 0%, \r\n    rgba(255, 255, 255, 0.95) 50%, \r\n    rgba(255, 255, 255, 1) 100%\r\n  );\r\n  backdrop-filter: blur(20px);\r\n  -webkit-backdrop-filter: blur(20px);\r\n}\r\n\r\n.tabbar-border {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 1rpx;\r\n  background: linear-gradient(90deg, \r\n    transparent 0%, \r\n    rgba(61, 69, 230, 0.1) 50%, \r\n    transparent 100%\r\n  );\r\n}\r\n\r\n.tabbar-content {\r\n  position: relative;\r\n  display: flex;\r\n  height: 120rpx;\r\n  align-items: center;\r\n  justify-content: space-around;\r\n  padding: 0 20rpx;\r\n}\r\n\r\n.tab-item {\r\n  flex: 1;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n  padding: 10rpx 0;\r\n  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\r\n}\r\n\r\n.tab-glow {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 90rpx;\r\n  height: 90rpx;\r\n  background: radial-gradient(circle, rgba(61, 69, 230, 0.15) 0%, transparent 70%);\r\n  border-radius: 50%;\r\n  animation: glow-pulse 2s ease-in-out infinite;\r\n}\r\n\r\n@keyframes glow-pulse {\r\n  0%, 100% {\r\n    transform: translate(-50%, -50%) scale(1);\r\n    opacity: 0.5;\r\n  }\r\n  50% {\r\n    transform: translate(-50%, -50%) scale(1.2);\r\n    opacity: 0.8;\r\n  }\r\n}\r\n\r\n.tab-icon-wrapper {\r\n  position: relative;\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.tab-svg-icon {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n  transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n}\r\n\r\n.tab-svg-icon.active {\r\n  animation: icon-bounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);\r\n}\r\n\r\n/* 首页图标样式 */\r\n.svg-home {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.home-base {\r\n  position: absolute;\r\n  bottom: 10rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 38rpx;\r\n  height: 24rpx;\r\n  background: #999;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tab-svg-icon.active .home-base {\r\n  background: #3d45e6;\r\n}\r\n\r\n.home-roof {\r\n  position: absolute;\r\n  top: 8rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 24rpx solid transparent;\r\n  border-right: 24rpx solid transparent;\r\n  border-bottom: 20rpx solid #999;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tab-svg-icon.active .home-roof {\r\n  border-bottom-color: #3d45e6;\r\n}\r\n\r\n.home-door {\r\n  position: absolute;\r\n  bottom: 10rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 10rpx;\r\n  height: 14rpx;\r\n  background: white;\r\n  border-radius: 1rpx;\r\n}\r\n\r\n/* 订单图标样式 */\r\n.svg-order {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.order-paper {\r\n  position: absolute;\r\n  top: 6rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 36rpx;\r\n  height: 46rpx;\r\n  background: #999;\r\n  border-radius: 4rpx;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tab-svg-icon.active .order-paper {\r\n  background: #3d45e6;\r\n}\r\n\r\n.order-lines {\r\n  position: absolute;\r\n  top: 16rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 24rpx;\r\n  height: 2rpx;\r\n  background: white;\r\n  box-shadow: 0 8rpx 0 white, 0 16rpx 0 white;\r\n}\r\n\r\n.order-check {\r\n  position: absolute;\r\n  top: 38rpx;\r\n  right: 6rpx;\r\n  width: 10rpx;\r\n  height: 10rpx;\r\n  background: #4CAF50;\r\n  border-radius: 50%;\r\n  animation: check-appear 0.3s ease-out;\r\n}\r\n\r\n@keyframes check-appear {\r\n  0% {\r\n    transform: scale(0);\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    transform: scale(1);\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* 我的图标样式 */\r\n.svg-profile {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.profile-head {\r\n  position: absolute;\r\n  top: 8rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 22rpx;\r\n  height: 22rpx;\r\n  background: #999;\r\n  border-radius: 50%;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tab-svg-icon.active .profile-head {\r\n  background: #3d45e6;\r\n}\r\n\r\n.profile-body {\r\n  position: absolute;\r\n  bottom: 8rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 38rpx;\r\n  height: 24rpx;\r\n  background: #999;\r\n  border-radius: 19rpx 19rpx 0 0;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tab-svg-icon.active .profile-body {\r\n  background: #3d45e6;\r\n}\r\n\r\n@keyframes icon-bounce {\r\n  0% {\r\n    transform: scale(1);\r\n  }\r\n  50% {\r\n    transform: scale(1.2) translateY(-4rpx);\r\n  }\r\n  100% {\r\n    transform: scale(1);\r\n  }\r\n}\r\n\r\n.icon-dot {\r\n  position: absolute;\r\n  top: -6rpx;\r\n  right: -6rpx;\r\n  width: 16rpx;\r\n  height: 16rpx;\r\n  background: linear-gradient(135deg, #3d45e6 0%, #5b63f5 100%);\r\n  border-radius: 50%;\r\n  border: 2rpx solid white;\r\n  animation: dot-pulse 1.5s ease-in-out infinite;\r\n}\r\n\r\n@keyframes dot-pulse {\r\n  0%, 100% {\r\n    transform: scale(1);\r\n    box-shadow: 0 0 0 0 rgba(61, 69, 230, 0.7);\r\n  }\r\n  50% {\r\n    transform: scale(1.1);\r\n    box-shadow: 0 0 0 8rpx rgba(61, 69, 230, 0);\r\n  }\r\n}\r\n\r\n.tab-text {\r\n  font-size: 22rpx;\r\n  color: #999;\r\n  font-weight: 400;\r\n  transition: all 0.3s ease;\r\n  letter-spacing: 0.5rpx;\r\n}\r\n\r\n.tab-text.active {\r\n  color: #3d45e6;\r\n  font-weight: 600;\r\n  transform: scale(1.05);\r\n}\r\n\r\n.active-indicator {\r\n  position: absolute;\r\n  bottom: -2rpx;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 30rpx;\r\n  height: 6rpx;\r\n  background: linear-gradient(90deg, #3d45e6 0%, #5b63f5 100%);\r\n  border-radius: 3rpx;\r\n  animation: indicator-slide-in 0.3s ease-out;\r\n}\r\n\r\n@keyframes indicator-slide-in {\r\n  0% {\r\n    width: 0;\r\n    opacity: 0;\r\n  }\r\n  100% {\r\n    width: 30rpx;\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* 深色模式支持 */\r\n@media (prefers-color-scheme: dark) {\r\n  .custom-tabbar {\r\n    background: rgba(28, 28, 30, 0.95);\r\n  }\r\n  \r\n  .tabbar-blur-bg {\r\n    background: linear-gradient(180deg, \r\n      rgba(28, 28, 30, 0.9) 0%, \r\n      rgba(28, 28, 30, 0.95) 50%, \r\n      rgba(28, 28, 30, 1) 100%\r\n    );\r\n  }\r\n  \r\n  .tab-text {\r\n    color: #8e8e93;\r\n  }\r\n  \r\n  .tab-text.active {\r\n    color: #007aff;\r\n  }\r\n}\r\n\r\n/* 支付宝小程序适配 */\r\n.custom-tabbar {\r\n  box-shadow: 0 -2rpx 20rpx rgba(0, 0, 0, 0.1);\r\n  /* 硬件加速 */\r\n  transform: translateZ(0);\r\n  -webkit-transform: translateZ(0);\r\n  /* 防止在某些设备上出现白线 */\r\n  border-top: 1rpx solid rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n/* 优化毛玻璃效果的兼容性 */\r\n@supports not (backdrop-filter: blur(20px)) {\r\n  .custom-tabbar,\r\n  .tabbar-blur-bg {\r\n    background: rgba(255, 255, 255, 0.98);\r\n  }\r\n}\r\n\r\n/* 针对支付宝小程序的特殊优化 */\r\n/* #ifdef MP-ALIPAY */\r\n.custom-tabbar {\r\n  background: rgba(255, 255, 255, 0.98);\r\n  backdrop-filter: none;\r\n  -webkit-backdrop-filter: none;\r\n}\r\n\r\n.tabbar-blur-bg {\r\n  background: linear-gradient(180deg, \r\n    rgba(255, 255, 255, 0.95) 0%, \r\n    rgba(255, 255, 255, 1) 100%\r\n  );\r\n  backdrop-filter: none;\r\n  -webkit-backdrop-filter: none;\r\n}\r\n/* #endif */\r\n\r\n/* 确保在所有设备上都有良好的性能 */\r\n.tab-item,\r\n.tab-svg-icon,\r\n.tab-text {\r\n  will-change: transform, color;\r\n}\r\n</style>\r\n","import Component from 'D:/workspace/ClientWorkArea/证照小程序/miniapp/zfb-uniapp/components/custom-tabbar/custom-tabbar.vue'\nmy.createComponent(Component)"],"names":["uni"],"mappings":";;AA8DA,MAAK,YAAU;AAAA,EACb,MAAM;AAAA,EACN,OAAO;AAAA,IACL,YAAY;AAAA,MACV,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,gBAAgB;AAAA,MAChB,SAAS;AAAA,QACP;AAAA,UACE,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,kBAAkB;AAAA,QACnB;AAAA,QACD;AAAA,UACE,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,kBAAkB;AAAA,QACnB;AAAA,QACD;AAAA,UACE,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,kBAAkB;AAAA,QACpB;AAAA,MACF;AAAA,IACF;AAAA,EACD;AAAA,EACD,UAAU;AACR,SAAK,kBAAkB;AAAA,EACxB;AAAA,EACD,SAAS;AAAA;AAAA,IAEP,gBAAgB;AACd,UAAI;AACF,cAAM,QAAQ,gBAAgB;AAC9B,YAAI,MAAM,SAAS,GAAG;AACpB,gBAAM,cAAc,MAAM,MAAM,SAAS,CAAC;AAC1C,gBAAM,QAAQ,YAAY,SAAS,YAAY;AAE/CA,wBAAAA,MAAY,MAAA,OAAA,qDAAA,WAAW,KAAK;AAE5B,eAAK,QAAQ,QAAQ,CAAC,MAAM,UAAU;AACpC,kBAAM,WAAW,KAAK,SAAS,QAAQ,KAAK,EAAE;AAC9C,gBAAI,UAAU,MAAM,SAAS,QAAQ,KAAK,UAAU,WAAW;AAC7D,mBAAK,aAAa;AAClBA,4BAAY,MAAA,MAAA,OAAA,qDAAA,YAAY,OAAO,QAAQ;AAAA,YACzC;AAAA,WACD;AAAA,QACH;AAAA,MACF,SAAS,GAAG;AACVA,sBAAAA,MAAY,MAAA,OAAA,qDAAA,aAAa,CAAC;AAE1B,cAAM,MAAM,OAAO,WAAW,OAAO,SAAS,OAAO;AACrD,YAAI,IAAI,SAAS,MAAM,GAAG;AACxB,eAAK,aAAa;AAAA,QACpB,WAAW,IAAI,SAAS,OAAO,GAAG;AAChC,eAAK,aAAa;AAAA,QACpB,WAAW,IAAI,SAAS,SAAS,GAAG;AAClC,eAAK,aAAa;AAAA,QACpB;AAAA,MACF;AAAA,IACD;AAAA;AAAA,IAGD,oBAAoB;AAClB,UAAI;AACF,cAAM,aAAaA,cAAG,MAAC,kBAAkB;AACzC,cAAM,WAAW,WAAW,YAAY,CAAC;AACzC,cAAM,eAAe,WAAW,gBAAgB,WAAW;AAG3D,YAAI,WAAW,aAAa,OAAO;AAEjC,eAAK,iBAAiB,gBAAgB,SAAS,UAAU;AAEzD,cAAI,KAAK,iBAAiB,IAAI;AAC5B,iBAAK,iBAAiB,WAAW,kBAAkB,KAAK,KAAK;AAAA,UAC/D;AAAA,eACK;AAEL,eAAK,iBAAiB,KAAK,IAAI,GAAG,gBAAgB,SAAS,UAAU,aAAa;AAAA,QACpF;AAEAA,sBAAY,MAAA,MAAA,OAAA,qDAAA,aAAa,KAAK,cAAc;AAAA,MAC9C,SAAS,GAAG;AACVA,sBAAAA,MAAY,MAAA,OAAA,qDAAA,aAAa,CAAC;AAC1B,aAAK,iBAAiB;AAAA,MACxB;AAAA,IACD;AAAA;AAAA,IAGD,UAAU,OAAO;AACf,UAAI,KAAK,eAAe;AAAO;AAG/B,WAAK,MAAM,cAAc,KAAK;AAG9BA,oBAAAA,MAAI,aAAa;AAAA,QACf,MAAM;AAAA,OACP;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1KA,GAAG,gBAAgB,SAAS;"}